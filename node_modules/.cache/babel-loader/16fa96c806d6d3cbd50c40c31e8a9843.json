{"remainingRequest":"/Users/pwm/www/ui/ShopOA/node_modules/babel-loader/lib/index.js!/Users/pwm/www/ui/ShopOA/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/pwm/www/ui/ShopOA/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/pwm/www/ui/ShopOA/src/components/MtMessage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/pwm/www/ui/ShopOA/src/components/MtMessage.vue","mtime":1561600366122},{"path":"/Users/pwm/www/ui/ShopOA/node_modules/cache-loader/dist/cjs.js","mtime":1561365392055},{"path":"/Users/pwm/www/ui/ShopOA/node_modules/babel-loader/lib/index.js","mtime":1561365391859},{"path":"/Users/pwm/www/ui/ShopOA/node_modules/cache-loader/dist/cjs.js","mtime":1561365392055},{"path":"/Users/pwm/www/ui/ShopOA/node_modules/vue-loader/lib/index.js","mtime":1561365398190}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _objectSpread from \"/Users/pwm/www/ui/ShopOA/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport config from \"../config\";\nimport { mapActions } from 'vuex';\nimport axios from 'axios';\nimport { setTimeout } from 'timers';\nexport default {\n  props: {\n    form: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    newForm: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    dialogFormVisible: {\n      type: Boolean,\n      default: function _default() {\n        return false;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      dialogImageUrl: '',\n      dialogVisible: false,\n      fileList: [],\n      file: {},\n      imgs: []\n    };\n  },\n  methods: _objectSpread({}, mapActions(['getAliyunPara', 'postImg']), {\n    handleRemove: function handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    handlePictureCardPreview: function handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n      console.log(file);\n    },\n    imgCallBack: function imgCallBack(e) {\n      //定义唯一的文件名，打印出来的uid其实就是时间戳\n      var client = new OSS.Wrapper({\n        region: e.endpoint,\n        accessKeyId: e.accessId,\n        //填入自己的id\n        accessKeySecret: e.accessSecret,\n        //填入自己的id\n        bucket: e.bucket,\n        stsToken: localStorage.getItem('token')\n      });\n      console.log(this.file.file);\n      var contens = this.file['name'].split('.');\n      var ext = contens[contens.length - 1];\n      var filename = \"/shopImg/\".concat(Math.random().toString(36).substr(2), \".\").concat(ext); // var signUrl = client.signatureUrl(filename, {expires: 6000, 'process' : 'image/resize,w_300'});\n      // console.log(signUrl);\n\n      var ret = client.multipartUpload(filename, this.file.file, {}).then(function (result) {\n        console.log(result);\n        vm.$message({\n          type: 'success',\n          message: '图片上传成功'\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    Upload: function Upload(file) {\n      var _this = this;\n\n      this.file = file.file;\n      setTimeout(function () {\n        _this.getAliyunPara(_this.imgCallBack);\n      }); //    console.log(file.file);\n      //    this.$store.state.file =  Object.assign({},file,{drive:'oss'})\n      //    this.postImg(this.upCallBack)\n\n      var mfile = file.file;\n      var param = new FormData(); //创建form对象\n\n      param.append('file', mfile); //通过append向form对象添加数据\n\n      var config = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }; //添加请求头\n\n      axios.post('http://admin.qiandengli.com/file/images', param, config).then(function (response) {\n        console.log(response.data.data.url);\n\n        _this.imgs.push(response.data.data.url);\n      });\n    },\n    upCallBack: function upCallBack(e) {},\n    tabClick: function tabClick(e) {\n      if (e === 0) {\n        this.$router.push('/shopList');\n      } else if (e === 1) {\n        this.$emit('changeTab', 0);\n      } else if (e === 2) {\n        this.$emit('changeTab', 2);\n      } else {\n        this.$emit('changeTab', 2);\n        this.$store.state.ImgVideo.images = [].concat(this.imgs);\n      }\n    }\n  }),\n  created: function created() {}\n};",{"version":3,"sources":["MtMessage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"mt-form-ctn\">\n        <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\n            <el-form-item label=\"商品图片\">\n               <el-upload\n                    action=\"\"\n                    :http-request=\"Upload\" \n                    list-type=\"picture-card\"\n                    :on-preview=\"handlePictureCardPreview\"\n                    :on-remove=\"handleRemove\">\n                    <i class=\"el-icon-plus\"></i>\n                </el-upload>\n                <el-dialog :visible.sync=\"dialogVisible\" size=\"tiny\">\n                    <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n                </el-dialog>\n                <p class=\"ys-tip-text\">至少上传一张商品图片。当前首页商品模板选择了 模板一，主图建议上传375 * 375px的图片，用于展示在商品图为正方形的区域。商家设置 -> 基本信息，商品图片选择了长方形，其它图片建议上传375 * 240px，展示在商品详情页。</p>\n            </el-form-item>\n            <el-form-item label=\"商品视频\">\n               <el-upload\n                class=\"upload-demo\"\n                drag\n                action=\"https://jsonplaceholder.typicode.com/posts/\"\n                multiple>\n                <i class=\"el-icon-upload\"></i>\n                <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n                <div class=\"el-upload__tip\" slot=\"tip\">上传视频大小不能超过20M，视频支持格式：mp4, avi, mpeg, quicktime</div>\n                </el-upload>\n            </el-form-item>\n        </el-form>\n        <div class=\"bottom-wrap\">\n            <el-button @click=\"tabClick(0)\"  size = 'mini'>取消</el-button>\n            <el-button @click=\"tabClick(1)\" size = 'mini' type=\"primary\">上一步</el-button>\n            <!-- <el-button @click=\"tabClick(2)\" size = 'mini' type=\"primary\">下一步</el-button> -->\n            <el-button @click=\"tabClick(3)\" size = 'mini' type=\"primary\">保存</el-button>\n        </div>\n    </div>\n</template>\n\n<script>\n\nimport config from '../config'\nimport { mapActions } from 'vuex';\nimport axios from 'axios'\nimport { setTimeout } from 'timers';\nexport default {\n    props:{\n        form:{\n            type:Object,\n            default:()=>{\n                return {\n\n                }\n            }\n        },\n        newForm:{\n            type: Object,\n            default:() => {\n                return{\n\n                }\n            }\n        },\n        dialogFormVisible:{\n            type:Boolean,\n            default:()=>{\n                return false\n            }\n        }\n    },\n    data(){\n        return{\n            dialogImageUrl: '',\n            dialogVisible: false,\n            fileList:[],\n            file:{},\n            imgs:[]\n        }\n    },\n    methods:{\n        ...mapActions(['getAliyunPara', 'postImg']),\n        handleRemove(file, fileList) {\n            console.log(file, fileList);\n        },\n        handlePictureCardPreview(file) {\n            this.dialogImageUrl = file.url;\n            this.dialogVisible = true;\n            console.log(file);\n            \n        },\n        imgCallBack(e){\n\n        //定义唯一的文件名，打印出来的uid其实就是时间戳\n        \n        \n            const client = new OSS.Wrapper({\n                                region: e.endpoint,\n                                accessKeyId: e.accessId,//填入自己的id\n                                accessKeySecret: e.accessSecret,//填入自己的id\n                                bucket: e.bucket,\n                                stsToken: localStorage.getItem('token')\n                            })\n                             console.log(this.file.file);\n              const contens = this.file['name'].split('.');\n              \n             const ext = contens[contens.length - 1];\n             const filename = `/shopImg/${Math.random().toString(36).substr(2)}.${ext}`;\n             \n             \n            // var signUrl = client.signatureUrl(filename, {expires: 6000, 'process' : 'image/resize,w_300'});\n            // console.log(signUrl);\n           \n            \n            const ret = client.multipartUpload(filename, this.file.file, {}).then((result) => {\n                console.log(result);\n                \n                vm.$message({\n                type: 'success',\n                message: '图片上传成功',\n                });\n            }).catch((err) => {\n                console.log(err);\n            });\n        },\n        Upload(file) {\n\n            this.file = file.file\n            setTimeout(()=>{\n                this.getAliyunPara( this.imgCallBack);\n            })\n            \n            \n        //    console.log(file.file);\n        //    this.$store.state.file =  Object.assign({},file,{drive:'oss'})\n        //    this.postImg(this.upCallBack)\n\n            let mfile = file.file;\n            let param = new FormData(); //创建form对象\n            param.append('file',mfile);//通过append向form对象添加数据\n            \n            let config = {\n            headers:{'Content-Type':'multipart/form-data'}\n            }; //添加请求头\n            axios.post('http://admin.qiandengli.com/file/images',param,config)\n            .then(response=>{\n                console.log(response.data.data.url);\n                this.imgs.push(response.data.data.url)\n            })\n\n             \n        },\n        upCallBack(e){\n\n        },\n        tabClick(e){\n            if (e === 0) {\n                this.$router.push('/shopList')\n            } \n            else if(e === 1) {\n                this.$emit('changeTab',0)\n            }\n            else if(e === 2) {\n                this.$emit('changeTab',2)\n            }else {\n                 this.$emit('changeTab',2)\n                this.$store.state.ImgVideo.images = [].concat(this.imgs)\n            }\n        }\n     \n      \n    },\n    created(){\n        \n    }\n}\n</script>\n<style>\n.mt-form-ctn {\n    flex: 1;\n    padding-top: 20px;\n    background-color: #fff;\n}\n.ys-tip-text {\n    font-size: 12px;\n    color: #999;\n    margin-left: 50px;\n}\n.bottom-wrap {\n    margin-top: 40px;\n    height: 30px;\n}\n</style>\n\n"],"sourceRoot":"src/components"}]}